{% extends "layout.html" %}

{% block title %}Update {{ field.replace('_', ' ').title() }} | Soaporium{% endblock %}

{% block content %}
<!-- Flash Messages for Errors or Other Notifications -->
{% with messages = get_flashed_messages(with_categories=True) %}
{% if messages %}
<div class="flash-messages">
    {% for category, message in messages %}
    <div class="alert {{ category }}">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}


<div class="update-info-container">
    <h2>Update {{ valid_fields[field] }}</h2>
    <form method="POST" action="{{ url_for('update_info', field=field) }}" class="update-form">
        {% if field == 'password' %}
        <label for="password">New Password</label>
        <input type="password" id="password" name="password" required>

        <label for="confirm-password">Confirm Password</label>
        <input type="password" id="confirm-password" name="confirm-password" required>

        {% elif field == 'address' %}
        <!-- Address Update Fields -->
        <label for="housenum">House Number</label>
        <input type="text" id="housenum" name="housenum" pattern="\d+" required
            oninvalid="this.setCustomValidity('Please enter a valid house number (only digits).')"
            oninput="this.setCustomValidity('')">

        <label for="street">Street</label>
        <input type="text" id="street" name="street" pattern="[A-Za-z\s]+" required>

        <label for="suburb">Suburb</label>
        <input type="text" id="suburb" name="suburb" pattern="[A-Za-z\s]+" required>

        <label for="town">Town</label>
        <input type="text" id="town" name="town" pattern="[A-Za-z\s]+" required>

        <label for="region">Region</label>
        <input type="text" id="region" name="region" pattern="[A-Za-z\s]+" required>

        <label for="country">Country</label>
        <input type="text" id="country" name="country" pattern="[A-Za-z\s]+" required>

        <label for="postcode">Postcode</label>
        <input type="text" id="postcode" name="postcode" pattern="\d{4,10}" required
            oninvalid="this.setCustomValidity('Postcode must be 4-10 digits long.')"
            oninput="this.setCustomValidity('')">

        {% else %}
        <!-- Generic Text Input -->
        <label for="{{ field }}">{{ valid_fields[field] }}</label>
        <input type="text" id="{{ field }}" name="{{ field }}" required>
        {% endif %}

        <button type="submit" class="update-button">Update {{ valid_fields[field] }}</button>
    </form>
    <br>
    <a href="{{ url_for('userinfo', userid=userid) }}"><button type="button" class="cancel-button">Cancel</button></a>
</div>
{% endblock %}