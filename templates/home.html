{% extends "layout.html" %}

{% block title %}Home | Soaporium{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="home-page">
    <div class="hero-section">
        <h1>Welcome to Soaporium</h1>
        <p>Discover our amazing handcrafted soaps</p>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="alert {{ category }}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}  

<!-- Featured Soaps Carousel -->
<div class="featured-soaps">
    <h2>Featured Soaps</h2>
    <div class="carousel-container">
        <div class="carousel">
            {% for item in featured_items %}
            <div class="carousel-item">
                <a href="{{ url_for('search', search_term=item[0]) }}">
                    <img src="{{ item[1] }}" alt="{{ item[0] }}">
                    <h3>{{ item[0] }}</h3>
                    <p>{{ item[2] }}</p>
                </a>
            </div>
            {% endfor %}
        </div>
        <button class="carousel-control prev" onclick="moveCarousel(-1)">❮</button>
        <button class="carousel-control next" onclick="moveCarousel(1)">❯</button>
    </div>
</div>

<!-- Soap Gallery Section -->
<div class="gallery-section">
    <h2>Soap Gallery</h2>
    <div class="gallery-items">
        {% for item in items %}
        <div class="gallery-item">
            <a href="{{ url_for('search', search_term=item[0]) }}">
                <img src="{{ item[1] }}" alt="{{ item[0] }}">
                <h4>{{ item[0] }}</h4>
            </a>
        </div>
        {% endfor %}
    </div>
</div>

<!-- JavaScript for Carousel, thanks to ChatGPT -->
<script>
    let currentIndex = 0;

    function moveCarousel(direction) {
        const carousel = document.querySelector('.carousel');
        const items = document.querySelectorAll('.carousel-item');
        const totalItems = items.length;

        // Calculate the new index
        currentIndex = (currentIndex + direction + totalItems) % totalItems;

        // Move the carousel
        carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
    }

    // Optional: Auto-scroll carousel every 5 seconds
    setInterval(() => moveCarousel(1), 5000);
</script>
{% endblock %}